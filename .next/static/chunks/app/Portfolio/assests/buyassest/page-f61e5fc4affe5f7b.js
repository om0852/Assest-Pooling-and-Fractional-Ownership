(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[467],{9119:function(e,t,n){Promise.resolve().then(n.bind(n,4959))},4959:function(e,t,n){"use strict";n.r(t);var o=n(7437),r=n(2265),a=n(4033);n(1396);var s=n(171);n(4193);var i=n(1490),c=n(9460);t.default=()=>{let[e,t]=(0,r.useState)(null),[n,l]=(0,r.useState)(null),[u,p]=(0,r.useState)(null),[d,m]=(0,r.useState)(0),[h,g]=(0,r.useState)(null),y=(0,a.useRouter)(),f=i.Z.get("price");(0,r.useEffect)(()=>{window.ethereum&&window.ethereum.on("accountsChanged",handleAccountsChanged),f||y.push("/"),setContract(),fetchEthereumPrice()},[]);let handleAccountsChanged=async e=>{g(e[0])},fetchEthereumPrice=async()=>{try{let e=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=inr"),t=await e.json();return t.ethereum.inr}catch(e){console.error("Error fetching Ethereum price:",e)}},setContract=async()=>{try{let e=new c.ZPm(window.ethereum);p(e);let n=await window.ethereum.request({method:"eth_requestAccounts"});console.log(n),g(n[0]);let o=new e.eth.Contract([{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"string",name:"",type:"string"}],name:"balances",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"contractBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"id",type:"string"}],name:"deposit",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"string",name:"id",type:"string"}],name:"getBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"id",type:"string"},{internalType:"uint256",name:"_amount",type:"uint256"},{internalType:"address payable",name:"_receiver",type:"address"}],name:"withdraw",outputs:[],stateMutability:"payable",type:"function"}],"0x930BC5ec6339AbC9343de0b5c1b5C1b4163670c8");console.log(o),t(o)}catch(e){alert("connect to network")}},[b,w]=(0,r.useState)({useremail:"",BuyAmount:"",pid:"",PortfolioTotalPrice:"",Transactionid:null,Transactionamount:null,OrginalBuyPrice:""}),onchange=e=>{let t=window.location.search,n=new URLSearchParams(t),o=n.get("pid"),r=localStorage.getItem("APFOS_useremail"),a=e.target.value;w({...b,useremail:r,BuyAmount:a,pid:o,PortfolioTotalPrice:f,OrginalBuyPrice:a})},BuyAssest=async t=>{if(t.preventDefault(),b.BuyAmount>1&&b.BuyAmount<=2e3)try{let n;let o=window.location.search,r=new URLSearchParams(o),a=r.get("pid");console.log(u);try{n=await fetchEthereumPrice(),console.log(n)}catch(e){return alert("check internet connection,try again")}let s=parseFloat(b.BuyAmount)/parseFloat(n);console.log(s);let i=await e.methods.deposit(a).estimateGas({from:h,value:u.utils.toWei(s.toString(),"ether")});console.log("Gas Estimation:",i);let c=await e.methods.deposit(a).send({from:h,value:u.utils.toWei(s.toString(),"ether"),gas:i});console.log(c),l(c.transactionHash),await handleSubmit(t,c,s)}catch(e){return console.log(e),clearInterval(),alert("invalid attempt,try again")}else s.toast.error("Invalid Amount [".concat(1,"-",2e3,"]"),{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})},handleSubmit=async(e,t,n)=>{e.preventDefault(),console.log(b);let o=window.location.href,r=new URL(o).hostname,a=new URL(o).protocol,c=new URL(o).port?":".concat(new URL(o).port):"",l="".concat(a,"//").concat(r).concat(c),u=await fetch("".concat(l,"/api/portfolio/Assest/BuyAssest"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({useremail:b.useremail,BuyAmount:b.BuyAmount,pid:b.pid,PortfolioTotalPrice:b.PortfolioTotalPrice,OrginalBuyPrice:b.OrginalBuyPrice,Transactionid:t.transactionHash,Transactionamount:n})}),p=await u.json();console.log(p),200===p.status?(s.toast.success("Assest Buy Successfully",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),i.Z.remove("price"),y.push("/Portfolio/assests/buyassestlist")):"Account Not Found"==p.error?(s.toast.error("Account Not Found",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),y.push("/login")):"Portfolio Not Found"==p.error?(s.toast.error("Portfolio Not Found",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),y.push("/")):201===p.status?(s.toast.error("Invalid Format",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),y.push("/")):s.toast.error("Empty Field",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),w({useremail:"",walletaddress:""})};return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto md:h-screen lg:py-0",children:[(0,o.jsx)("div",{className:"mb-6 md:mb-0 flex flex-row justify-center my-2",children:(0,o.jsxs)("p",{className:"text-2xl text-center text-white font-bold ml-3 bg-red-500 w-auto h-auto py-1 -2",children:[(0,o.jsx)("span",{className:" bg-black text-white px-2 py-1",children:"Bluechip"})," Art"," "]})}),(0,o.jsx)("div",{className:"w-full bg-white rounded-lg shadow md:mt-0 sm:max-w-md xl:p-0 ",children:(0,o.jsxs)("div",{className:"p-6 space-y-4 md:space-y-6 sm:p-8",children:[(0,o.jsx)("h1",{className:"text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl ",children:"Transaction Page"}),(0,o.jsxs)("form",{className:"space-y-4 md:space-y-6",method:"POST",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 ",children:"Enter Amount"}),(0,o.jsx)("input",{onChange:e=>onchange(e),type:"number",name:"BuyAmount",id:"BuyAmount",className:"bg-white border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"min:10rs",required:"true"})]}),(0,o.jsx)("button",{onClick:e=>BuyAssest(e),type:"submit",className:"w-full text-white bg-blue-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Add"})]})]})})]})}},4193:function(){},1490:function(e,t,n){"use strict";/*! js-cookie v3.0.5 | MIT */function assign(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}n.d(t,{Z:function(){return o}});var o=function init(e,t){function set(n,o,r){if("undefined"!=typeof document){"number"==typeof(r=assign({},t,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var s in r)r[s]&&(a+="; "+s,!0!==r[s]&&(a+="="+r[s].split(";")[0]));return document.cookie=n+"="+e.write(o,n)+a}}return Object.create({set,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],o={},r=0;r<n.length;r++){var a=n[r].split("="),s=a.slice(1).join("=");try{var i=decodeURIComponent(a[0]);if(o[i]=e.read(s,i),t===i)break}catch(e){}}return t?o[t]:o}},remove:function(e,t){set(e,"",assign({},t,{expires:-1}))},withAttributes:function(e){return init(this.converter,assign({},this.attributes,e))},withConverter:function(e){return init(assign({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){e.O(0,[724,113,492,971,864,744],function(){return e(e.s=9119)}),_N_E=e.O()}]);