(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{2480:function(){},2339:function(e,s,o){Promise.resolve().then(o.bind(o,2109))},2109:function(e,s,o){"use strict";o.r(s);var t=o(7437),r=o(2265);o(1396);var a=o(4033),l=o(171);o(4193);var n=o(4155);s.default=()=>{let e=(0,a.useRouter)();(0,r.useEffect)(()=>{localStorage.getItem("token")&&e.push("/")},[]);let[s,o]=(0,r.useState)(""),[d,i]=(0,r.useState)({otp:"",password:"",cpassword:""}),[c,p]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),handleEmailChange=e=>{e.preventDefault(),o(e.target.value)},handleotpChange=e=>{e.preventDefault();let s=e.target.name,o=e.target.value;i({...d,[s]:o}),console.log(d)},handleSubmit=async e=>{e.preventDefault();let o=await fetch("".concat("http://localhost:3000/","api/sendEmail"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}),t=await o.json();console.log(t),200===t.status?(m(!0),p(t.otp),l.toast.success("Email sent succesfully",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})):201===t.status?(m(!1),l.toast.error("User not found.Please register",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})):401===t.status?(m(!1),l.toast.error("Please enter your email",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})):(m(!1),l.toast.error("Failed to send email.Try again",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}))},verifyotp=async t=>{t.preventDefault();let r=n.AES.decrypt(c,"secretkey123"),a=r.toString(n.enc.Utf8);if(console.log(a,d.otp),d.otp&&d.password&&d.cpassword){if(d.password.length>=8&&d.cpassword.length>=8&&d.password==d.cpassword){if(a==d.otp){let t=await fetch("".concat("http://localhost:3000/","/api/newpassword"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:s,password:d.password})}),r=await t.json();200==r.status?(l.toast.success("Password Reseted Successfully",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),localStorage.removeItem("token"),localStorage.removeItem("APFOS_useremail")):400==r.status?l.toast.error("User Not Found",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}):l.toast.error("Failed to reset Password",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),e.push("/login"),o(""),i({otp:"",password:"",cpassword:""}),p("")}else l.toast.error("Invalid OTP",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),e.push("/login"),o(""),i({otp:"",password:"",cpassword:""}),p("")}else l.toast.error("Please Check Password Fields",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})}else l.toast.error("Please fill all fields",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})};return(0,t.jsx)("div",{className:"mx-auto max-w-screen-xl px-4 py-16 sm:px-6 lg:px-8 min-h-screen",children:(0,t.jsxs)("div",{className:"mx-auto max-w-lg",children:[(0,t.jsx)("h1",{className:"text-center text-2xl font-bold text-pink-600 sm:text-3xl",children:"Reset Password"}),(0,t.jsx)("p",{className:"mx-auto mt-4 max-w-md text-center text-gray-500",children:"Reset password email was sent your email.Kindly see your email and reset your password"}),!u&&(0,t.jsxs)("form",{method:"POST",required:!0,className:"mb-0 mt-6 rounded-lg p-4 shadow-lg sm:p-6 lg:p-8",children:[(0,t.jsx)("p",{className:"text-center text-lg font-medium ",children:"Forgot Password"}),(0,t.jsx)("input",{onChange:e=>handleEmailChange(e),type:"email",required:"true",className:" w-full rounded-lg border-gray-200 p-4  text-sm shadow-sm",placeholder:"Enter your Email"}),(0,t.jsx)("button",{onClick:handleSubmit,type:"submit",className:"my-4 block w-full rounded-lg bg-pink-600 px-5 py-3 text-sm font-medium text-white",children:"Continue"})]}),u&&(0,t.jsx)("div",{class:"flex flex-col items-center justify-center px-6 py-3 mx-auto h-fit",children:(0,t.jsxs)("div",{class:"w-full p-6 bg-white rounded-lg shadow md:mt-0 sm:max-w-md  ",children:[(0,t.jsx)("h2",{class:"mb-1 text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl ",children:"Change Password"}),(0,t.jsxs)("form",{class:"mt-4 space-y-4 lg:mt-5 md:space-y-5",method:"POST",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Enter OTP"}),(0,t.jsx)("input",{onChange:e=>handleotpChange(e),type:"number",name:"otp",id:"otp",placeholder:"Enter OTP Sent to Your Email",class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 ",required:"true"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"New Password"}),(0,t.jsx)("input",{onChange:e=>handleotpChange(e),type:"password",name:"password",id:"password",placeholder:"••••••••",class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 ",required:"true"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{for:"confirm-password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Confirm password"}),(0,t.jsx)("input",{onChange:e=>handleotpChange(e),type:"cpassword",name:"cpassword",id:"cpassword",placeholder:"••••••••",class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 ",required:"true"})]}),(0,t.jsx)("button",{onClick:e=>verifyotp(e),type:"submit",class:"w-full text-white bg-green-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Reset passwod"})]})]})})]})})}}},function(e){e.O(0,[724,745,971,864,744],function(){return e(e.s=2339)}),_N_E=e.O()}]);