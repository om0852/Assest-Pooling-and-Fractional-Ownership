(()=>{var e={};e.id=9572,e.ids=[9572],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},6113:e=>{"use strict";e.exports=require("crypto")},52675:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>g,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>p});var t=r(73137),o=r(54647),a=r(4183),l=r.n(a),n=r(71775),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);r.d(s,i);let d=t.AppPageRouteModule,p=["",{children:["forgetpassword",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,53533)),"D:\\Assest-Pooling-and-Fractional-Ownershi\\src\\app\\forgetpassword\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,27415)),"D:\\Assest-Pooling-and-Fractional-Ownershi\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\Assest-Pooling-and-Fractional-Ownershi\\src\\app\\forgetpassword\\page.js"],u="/forgetpassword/page",g={require:r,loadChunk:()=>Promise.resolve()},m=new d({definition:{kind:o.x.APP_PAGE,page:"/forgetpassword/page",pathname:"/forgetpassword",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:p}})},17455:(e,s,r)=>{Promise.resolve().then(r.bind(r,51685))},51685:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var t=r(60080),o=r(9885);r(11440);var a=r(57114),l=r(34751);r(45996);var n=r(87683);let __WEBPACK_DEFAULT_EXPORT__=()=>{let e=(0,a.useRouter)();(0,o.useEffect)(()=>{localStorage.getItem("token")&&e.push("/")},[]);let[s,r]=(0,o.useState)(""),[i,d]=(0,o.useState)({otp:"",password:"",cpassword:""}),[p,c]=(0,o.useState)(""),[u,g]=(0,o.useState)(!1),handleEmailChange=e=>{e.preventDefault(),r(e.target.value)},handleotpChange=e=>{e.preventDefault();let s=e.target.name,r=e.target.value;d({...i,[s]:r}),console.log(i)},handleSubmit=async e=>{e.preventDefault();let r=await fetch("http://localhost:3000/api/sendEmail",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}),t=await r.json();console.log(t),200===t.status?(g(!0),c(t.otp),l.toast.success("Email sent succesfully",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})):201===t.status?(g(!1),l.toast.error("User not found.Please register",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})):401===t.status?(g(!1),l.toast.error("Please enter your email",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})):(g(!1),l.toast.error("Failed to send email.Try again",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}))},verifyotp=async t=>{t.preventDefault();let o=n.AES.decrypt(p,"secretkey123"),a=o.toString(n.enc.Utf8);if(console.log(a,i.otp),i.otp&&i.password&&i.cpassword){if(i.password.length>=8&&i.cpassword.length>=8&&i.password==i.cpassword){if(a==i.otp){let t=await fetch("http://localhost:3000//api/newpassword",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:s,password:i.password})}),o=await t.json();200==o.status?(l.toast.success("Password Reseted Successfully",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),localStorage.removeItem("token"),localStorage.removeItem("APFOS_useremail")):400==o.status?l.toast.error("User Not Found",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}):l.toast.error("Failed to reset Password",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),e.push("/login"),r(""),d({otp:"",password:"",cpassword:""}),c("")}else l.toast.error("Invalid OTP",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}),e.push("/login"),r(""),d({otp:"",password:"",cpassword:""}),c("")}else l.toast.error("Please Check Password Fields",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})}else l.toast.error("Please fill all fields",{position:"top-center",autoClose:1e3,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})};return t.jsx("div",{className:"mx-auto max-w-screen-xl px-4 py-16 sm:px-6 lg:px-8 min-h-screen",children:(0,t.jsxs)("div",{className:"mx-auto max-w-lg",children:[t.jsx("h1",{className:"text-center text-2xl font-bold text-pink-600 sm:text-3xl",children:"Reset Password"}),t.jsx("p",{className:"mx-auto mt-4 max-w-md text-center text-gray-500",children:"Reset password email was sent your email.Kindly see your email and reset your password"}),!u&&(0,t.jsxs)("form",{method:"POST",required:!0,className:"mb-0 mt-6 rounded-lg p-4 shadow-lg sm:p-6 lg:p-8",children:[t.jsx("p",{className:"text-center text-lg font-medium ",children:"Forgot Password"}),t.jsx("input",{onChange:e=>handleEmailChange(e),type:"email",required:"true",className:" w-full rounded-lg border-gray-200 p-4  text-sm shadow-sm",placeholder:"Enter your Email"}),t.jsx("button",{onClick:handleSubmit,type:"submit",className:"my-4 block w-full rounded-lg bg-pink-600 px-5 py-3 text-sm font-medium text-white",children:"Continue"})]}),u&&t.jsx("div",{class:"flex flex-col items-center justify-center px-6 py-3 mx-auto h-fit",children:(0,t.jsxs)("div",{class:"w-full p-6 bg-white rounded-lg shadow md:mt-0 sm:max-w-md  ",children:[t.jsx("h2",{class:"mb-1 text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl ",children:"Change Password"}),(0,t.jsxs)("form",{class:"mt-4 space-y-4 lg:mt-5 md:space-y-5",method:"POST",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Enter OTP"}),t.jsx("input",{onChange:e=>handleotpChange(e),type:"number",name:"otp",id:"otp",placeholder:"Enter OTP Sent to Your Email",class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 ",required:"true"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"New Password"}),t.jsx("input",{onChange:e=>handleotpChange(e),type:"password",name:"password",id:"password",placeholder:"••••••••",class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 ",required:"true"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{for:"confirm-password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Confirm password"}),t.jsx("input",{onChange:e=>handleotpChange(e),type:"cpassword",name:"cpassword",id:"cpassword",placeholder:"••••••••",class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 ",required:"true"})]}),t.jsx("button",{onClick:e=>verifyotp(e),type:"submit",class:"w-full text-white bg-green-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center ",children:"Reset passwod"})]})]})})]})})}},53533:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>l,__esModule:()=>a,default:()=>i});var t=r(17536);let o=(0,t.createProxy)(String.raw`D:\Assest-Pooling-and-Fractional-Ownershi\src\app\forgetpassword\page.js`),{__esModule:a,$$typeof:l}=o,n=o.default,i=n}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[4650,3254,8495,4503],()=>__webpack_exec__(52675));module.exports=r})();