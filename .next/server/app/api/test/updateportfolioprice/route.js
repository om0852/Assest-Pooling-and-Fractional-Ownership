"use strict";(()=>{var e={};e.id=6040,e.ids=[6040],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},18419:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>m,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>P,staticGenerationBailout:()=>y});var i={};r.r(i),r.d(i,{POST:()=>POST}),r(95655);var o=r(83323),a=r(54647),s=r(41312),n=r(36794),l=r(53904),p=r(66886);async function POST(e,t){try{let t=await e.json(),{updatedprice:r}=t;await (0,l.Z)();let i=await s.Z.find();for(let e=0;e<i.length;e++)if(i[e].PortfolioPrice[i[e].PortfolioPrice.length-1].Price!=r){let t=r-parseFloat(i[e].Price);i[e].PortfolioPrice.push({Price:r,date:new Date().toUTCString()}),await s.Z.updateOne({_id:i[e]._id},{Price:r,PortfolioPrice:i[e].PortfolioPrice});let o=await n.Z.find({AssestId:i[e]._id});if(o!=[])for(let r=0;r<o.length;r++){let a=t/100*parseFloat(o[r].PercentageOwn),l=parseFloat(o[r].AssestBuyPrice)+a,p=parseFloat(i[e].RemainingPrice)+t-a;console.log(t,a,l),await s.Z.updateOne({_id:i[e]._id},{RemainingPrice:p});let c=parseFloat(i[e].Price)-parseFloat(o[r].OrginalBuyPrice);console.log(parseFloat(i[e].Price),c,parseFloat(o[r].OrginalBuyPrice)),await n.Z.updateOne({_id:o[r]._id},{Profit:c,AssestBuyPrice:l,AssestTotalPrice:i[e].Price})}}else console.log("no update");return p.Z.json({status:200,error:i})}catch(e){return console.log(e),p.Z.json({status:300,error:"check internet connection"})}}let c=o.AppRouteRouteModule,u=new c({definition:{kind:a.x.APP_ROUTE,page:"/api/test/updateportfolioprice/route",pathname:"/api/test/updateportfolioprice",filename:"route",bundlePath:"app/api/test/updateportfolioprice/route"},resolvedPagePath:"D:\\Assest-Pooling-and-Fractional-Ownershi\\src\\app\\api\\test\\updateportfolioprice\\route.js",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:P,serverHooks:g,headerHooks:f,staticGenerationBailout:y}=u,m="/api/test/updateportfolioprice/route"},36794:(e,t,r)=>{r.d(t,{Z:()=>a});let i=r(11185),o=new i.Schema({AssestId:{type:String,required:!0},UserId:{type:String,required:!0},AssestTitle:{type:String,required:!0},AssestTotalPrice:{type:String,required:!0},OrginalBuyPrice:{type:String,required:!0},AssestBuyPrice:{type:String,required:!0},PercentageOwn:{type:String,required:!0},Transactionid:{type:String,required:!0},Transactionamount:{type:String,required:!0},Profit:{type:Array}},{timestamps:!0});i.models={};let a=i.model.Assest||i.model("Assests",o)}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[9727,6886,3904,782],()=>__webpack_exec__(18419));module.exports=r})();